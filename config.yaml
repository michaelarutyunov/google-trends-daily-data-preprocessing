# Google Trends Stitching Configuration
# Edit this file to change search term, date range, or stitching parameters

# Search parameters
search_term: "flu vaccine"
geo: "GB"  # Geographic location code (US, GB, DE, FR, etc.)

# Date range for analysis
date_range:
  start: "2022-05-15"
  end: "2025-08-07"

# Daily chunk parameters
daily:
  overlap_days: 83  # Range: [30, 180] - lower = fewer API calls, higher = more stable stitching

# Reproducibility (Note: Google Trends samples data, so not fully reproducible)
random_seed: 42

# Stitching weights for hierarchical optimization
stitching:
  weights:
    monthly: 1.0   # Fixed - most reliable ground truth
    weekly: 0.5    # Range: [0.3, 0.7] - balance between accuracy and stability
    overlap: 0.1   # Range: [0.05, 0.2] - soft constraint for chunk continuity

  # Zero handling (for seasonal search terms)
  zero_threshold: 0.01  # 1% - values below this considered zero
  structural_zero_months: [6, 7, 8]  # June-August for "flu vaccine" (off-season)
  # Adjust structural_zero_months based on your search term's seasonality

  # Optimization convergence parameters
  max_iterations: 1000  # IMPORTANT: default 100 is too low for 9+ chunks
  tolerance: 1.0e-8

  # Rung 4: Smooth Alpha Stitcher parameters
  smooth_alpha:
    lambda_smoothness: 10  # Range: [0.1, 1000.0] - higher = smoother alpha path
    # Use when: Alpha CV > 20%, suspected Google rebasing events

  # Rung 5: State-Space Stitcher parameters (EXPLORATORY - see nb/08)
  state_space:
    process_noise: 0.01  # State transition variance (Q matrix diagonal)
    observation_noise: 0.05  # Measurement variance (R matrix diagonal)
    confidence_level: 0.95  # For confidence band calculation
    # Use when: Need uncertainty quantification for downstream forecasting
    # NOTE: This is a heuristic implementation, not a true Kalman filter

# SerpAPI configuration
serpapi:
  timeout: 90  # Increased to 90s for daily data requests (can be slow)
  max_retries: 3  # Increased to handle intermittent timeouts
  retry_delay: 10  # seconds

# Output configuration
output:
  save_plots: true
  plot_format: "png"
  plot_dpi: 300

# Robustness testing (Phase 3)
robustness:
  overlap_tests: [30, 60, 90, 133]
  weight_tests:
    - [1.0, 0.3]
    - [1.0, 0.5]
    - [1.0, 0.7]
  temporal_cv:
    train_months: 24
    test_months: 6
    gap_months: 3
